{% extends "base.html" %}

{% block titulo %}Listas para buscar{% endblock %}

{% block css %}
{% load static %}
{% endblock %} 

{% block contenido %}
<div class="container">
    <div class="row">
        <div class="col-10">
            <h1>Listas de busquedas</h1>
        </div>
    </div>
    <div class="row mb-2">
        <div class="col-10">
            <button id="open_search">
                Crear nueva lista
            </button>
        </div>
    </div>
    <div class="row mb-2" id="new_list">
        <div class="col">
            <form action="/list/hunt/new" method="post">
                {% csrf_token %}
                <input type="text" name="new_list" id="new_list" placeholder="Nombre de nuevo listado">
               <button type="submit">Crear</button>
            </form>
        </div>
    </div>
    <div class="row">
        <div class="col-10">
           <p>LISTAS</p> 

            <div class="table-responsive">
                <table id="listas" class="table table-striped table-bordered" width="100%" >
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Cantidad de cartas</th>
                            <th class="dt-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for l in listas %}
                        <tr>
                            <td> 
                                <a href="/list/{{l.id}}">{{l.nombre}}</a>                      
                            </td>
                            <td> {{l.items.count}}</td>
                            <td class="dt-center"> 
                                <a href="/list/edit/{{l.id}}" class="btn btn-sm btn-outline-primary> <i class="bi bi-eye"></i></a>
                                    <a href="#"  data-href="/list/remove/{{l.id}}"  class="btn btn-sm btn-outline-danger btn-delete-trv" data-bs-toggle="modal" data-bs-target="#confirm-delete" title="Borrar">
                                        <i class="bi bi-trash"></i>
                                    </a>
                                   
                            </td>
                        </tr>       
                    {% endfor %}
                    </tbody>    
                </table>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="confirm-delete" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Eliminar</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                Esta seguro que desea eliminar esta lista?
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <a class="btn btn-danger btn-ok">Eliminar</a>
            </div>
        </div>
    </div>
</div>
<script>
     $(document).ready(function() {
        $('#new_list').hide();
        var oTblReport = $('#listas')

        oTblReport.DataTable({
            "language": { 
                "search": 'Buscar',
                "lengthMenu": "Mostrar _MENU_ registros por página",
                //"info": "Mostrando _ENTRIES_ página _PAGE_ de _PAGES_",
                "paginate":{
                    previous: '‹',
                    next:     '›'
                }
            },
            "aLengthMenu":[[5,10,15,25,-1],[5,10,15,25,"Todos"]],
            "iDisplayLength":20
        });
    });

    $('#open_search').on('click',function(){
        $('#new_list').fadeIn();
    });

    $('#confirm-delete').on('show.bs.modal', function(e) {
        $(this).find('.btn-ok').attr('href', $(e.relatedTarget).data('href'));
    }); 
</script>
{% endblock %}

{% block libreria %}
{% endblock %}